{% extends "base.html" %}
{% load static %}

{% block title %}Review & Edit: {{ article.title }} - Daily News{% endblock %}

{% block content %}
<div class="article-review-container">
    
    <form method="POST" enctype="multipart/form-data">
        {% csrf_token %}

        <div class="article-content-wrapper">
            <span class="status-badge status-{{ article.status|lower }}">{{ article.get_status_display }}</span>
            
            <div class="form-group mb-3">
                <label for="{{ form.title.id_for_label }}" class="h3">Article Title</label>
                {{ form.title }}
                {% for error in form.title.errors %}<small class="text-danger">{{ error }}</small>{% endfor %}
            </div>

            <p class="article-meta">
                By {{ article.author.username }} | Publisher: {{ article.publisher.name }}
                | Submitted: {{ article.creation_date|date:"F d, Y, P" }}
            </p>
            
            <div class="article-body form-group">
                <label for="{{ form.body.id_for_label }}" class="h4">Article Content</label>
                {{ form.body }} 
                {% for error in form.body.errors %}<small class="text-danger">{{ error }}</small>{% endfor %}
            </div>

            <hr>
            <div class="article-footer">
                <p><strong>Article Status History:</strong></p>
                <ul>
                    <li>Current Status: {{ article.get_status_display }}</li>
                    {% if article.last_edited_date %}
                        <li>Last Edited: {{ article.last_edited_date|date:"F d, Y, P" }} by {% if article.editor.is_active %}{{ article.editor.username }}{% else %}{{ article.author.username }}{% endif %}</li>
                    {% endif %}
                    {% if article.editor %}
                        <li>Last Reviewed By: {{ article.editor.username }}</li>
                    {% endif %}
                </ul>
            </div>
        </div>

        <div class="article-decision-form mt-5">
            <h3>Editor Actions</h3>
            <p class="summary-text">Delete or finalize the article.</p>
            
            <div class="form-actions-footer d-grid gap-2">
                <!-- <button type="submit" name="action" value="save" class="btn btn-primary btn-full-width">
                    Save Content Edits
                </button> -->
                
                <button type="submit" name="action" value="publish" class="btn btn-success btn-full-width">
                    Publish Article
                </button>
                
            </div>
        </div>
    </form>
    
    <div class="mt-3">
        <a href="{% url 'article_delete' pk=article.pk %}" class="btn btn-danger btn-full-width">
            Delete Article
        </a>
    </div>
    
    <a href="{% url 'editor_home' %}" class="btn btn-secondary btn-full-width mt-3">Back to Review Queue</a>

</div>
{% endblock content %}