{% extends "base.html" %}
{% load static %}

{% block title %}{{ article.title }} - Journalist View{% endblock %}

{% block content %}

<div class="article-journalist-view">
    
    <header class="journalist-article-actions-header">
        <a href="{% url 'journalist_home' %}" class="btn btn-secondary article-back-btn">
            &larr; Back to My Articles
        </a>
        
        <div class="action-buttons">
            <a href="{% url 'article_edit' article.pk %}" class="btn btn-secondary btn-edit">
                Edit
            </a>
            
            <button class="btn btn-delete btn-sm" data-article-id="{{ article.pk }}" onclick="confirmDelete(this)">
                Delete
            </button>
            
            <button class="btn submit-review-btn" onclick="submitForReview('{{ article.pk }}')">
                Submit for Review
            </button>
        </div>
    </header>

    <article class="full-article-content">
        
        <h1 class="article-detail-title">{{ article.title }}</h1>
        
        <div class="article-detail-meta">
            <span class="date-published">Created: {{ article.creation_date|date:"d M Y" }}</span>
            {% if article.last_edited_date %}
                | <span class="date-edited">Edited: {{ article.last_edited_date|date:"d M Y" }}</span>
            {% endif %}
            | <span class="status-indicator">Status: <span class="status-badge status-draft">Draft</span></span>
            | <span class="publisher-name">Publisher: {{ article.publisher_name|default:"N/A" }}</span>
        </div>

        <figure class="article-featured-image article-image-placeholder">
            
        </figure>

        <div class="article-body journalist-body">
            {{ article.body|safe }}
            
            <p><strong>Article Body:</strong> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam. Sed nisi. Nulla quis sem at nibh elementum imperdiet. Duis sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper porta. Mauris massa. Vestibulum lacinia arcu eget nulla.</p>

            <p>This is the content that the Journalist is currently working on. It remains in a **Draft** state until they explicitly click "Submit for Review". As the author, they have full control to view, edit, or delete the article until an editor takes possession of it for review/publishing.</p>
        </div>
        
    </article>

</div>

<script>
    function confirmDelete(button) {
        if (confirm("Are you sure you want to delete this article? This action cannot be undone.")) {
            // In Django, you'd submit a form or fetch a delete URL here
            console.log("Article ID " + button.getAttribute('data-article-id') + " deleted.");
            alert("Article deleted (Preview action)");
        }
    }
    
    function submitForReview(articleId) {
        if (confirm("Submit this article for Editor review?")) {
            // In Django, you'd change the article status to 'Awaiting Review' here
            console.log("Article ID " + articleId + " submitted for review.");
            alert("Article submitted for review (Preview action)");
        }
    }
</script>

{% endblock content %}