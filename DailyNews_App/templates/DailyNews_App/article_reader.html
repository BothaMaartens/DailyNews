{% extends "base.html" %}
{% load static %}

{% block title %}{{ article.title }} - Daily News{% endblock %}

{% block content %}

<div class="article-reader-view">
    
    <p style="margin-bottom: 20px;">
        <a href="{% url 'article_list' %}" class="btn btn-secondary btn-sm article-back-btn">
            &larr; Back to News Feed
        </a>
    </p>

    <article class="full-article-content">
        
        <h1 class="article-detail-title">{{ article.title }}</h1>
        
        <div class="article-detail-meta">
            <span class="date-published">Published: {{ article.publication_date|date:"d M Y" }}</span>
            {% if article.last_edited_date %}
                | <span class="date-edited">Edited: {{ article.last_edited_date|date:"d M Y" }}</span>
            {% endif %}
        </div>

        <div class="article-author-info">
            <img src="{% static 'img/journalist_profile_pic.png' %}" alt="{{ article.author.username }}" class="author-profile-pic">
            <div class="author-details">
                <span class="author-name">By: <a href="{% url 'journalist_profile' article.author.pk %}">{{ article.author.username }}</a></span>
                
                {% if article.publisher %}
                    <span class="publisher-name">Publisher: {{ article.publisher.name }}</span>
                {% endif %}
            </div>

            {% comment %} 
            The subscription buttons below rely on context flags like 'is_subscribed' 
            which were replaced by the 'toggle_subscription' forms in the article_list view. 
            For now, they are left as is, assuming they are part of a separate JS-driven subscription view.
            {% endcomment %}
            {% if not is_subscribed %}
            <button class="btn btn-secondary btn-sm subscribe-btn" data-journalist-id="{{ article.author.pk }}">
                Subscribe
            </button>
            {% else %}
            <button class="btn btn-sm btn-unsubscribe" data-journalist-id="{{ article.author.pk }}">
                Unsubscribe
            </button>
            {% endif %}
        </div>

        {% if article.featured_image %}
        <figure class="article-featured-image">
            <img src="{{ article.featured_image.url }}" alt="{{ article.title }}" class="full-image">
        </figure>
        {% else %}
        <figure class="article-featured-image article-image-placeholder">
            
        </figure>
        {% endif %}

        <div class="article-body">
            {{ article.body|safe }}
            
            </div>
        
    </article>
    
    <hr style="border-top: 1px solid var(--color-border); margin: 40px 0;">

    <section class="more-from-author">
        <h3>More from {{ article.author.username }}</h3>
        
        <div class="related-articles-grid">
            <div class="related-article-card">
                <h4 class="related-title"><a href="#">Related Article 1 Title</a></h4>
                <p class="related-meta">01 Nov 2025 | ActualToday</p>
            </div>
            <div class="related-article-card">
                <h4 class="related-title"><a href="#">Related Article 2 Title</a></h4>
                <p class="related-meta">30 Oct 2025 | SportToday</p>
            </div>
            <div class="related-article-card">
                <h4 class="related-title"><a href="#">Related Article 3 Title is Longer</a></h4>
                <p class="related-meta">28 Oct 2025 | ActualToday</p>
            </div>
        </div>
    </section>

</div>

{% endblock content %}